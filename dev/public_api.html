<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Public API · UnbalancedOptimalTransport.jl</title><link rel="canonical" href="https://ericphanson.github.io/UnbalancedOptimalTransport.jl/public_api.html"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">UnbalancedOptimalTransport.jl</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="optimal_transport.html">Optimal transport</a></li><li class="is-active"><a class="tocitem" href="public_api.html">Public API</a><ul class="internal"><li><a class="tocitem" href="#Functions-1"><span>Functions</span></a></li><li><a class="tocitem" href="#Sinkhorn&#39;s-algorithm-1"><span>Sinkhorn&#39;s algorithm</span></a></li><li><a class="tocitem" href="#Divergences-1"><span>Divergences</span></a></li><li><a class="tocitem" href="#Utilities-1"><span>Utilities</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="public_api.html">Public API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="public_api.html">Public API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/master/docs/src/public_api.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Public-API-1"><a class="docs-heading-anchor" href="#Public-API-1">Public API</a><a class="docs-heading-anchor-permalink" href="#Public-API-1" title="Permalink"></a></h1><p>This package provides one type, <a href="public_api.html#UnbalancedOptimalTransport.DiscreteMeasure"><code>DiscreteMeasure</code></a>, which describes a measure on a finite set for use in Sinkhorn&#39;s algorithm and the related functions. The first step to computing e.g. the Sinkhorn divergence (<a href="public_api.html#UnbalancedOptimalTransport.sinkhorn_divergence!"><code>sinkhorn_divergence!</code></a>) is to construct <code>DiscreteMeasure</code>&#39;s describing the quantities of interest.</p><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.DiscreteMeasure" href="#UnbalancedOptimalTransport.DiscreteMeasure"><code>UnbalancedOptimalTransport.DiscreteMeasure</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">DiscreteMeasure(density, [log_density], set) -&gt; DiscreteMeasure</code></pre><p>Construct a <code>DiscreteMeasure</code> object for use in <a href="public_api.html#UnbalancedOptimalTransport.unbalanced_sinkhorn!"><code>unbalanced_sinkhorn!</code></a> and related functions.</p><ul><li><code>density</code> should be strictly positive; zero elements should instead be removed</li></ul><p>from <code>set</code> * <code>log_density</code> should be equal to <code>log.(density)</code> and can be omitted (in which case its computed automatically) * <code>set</code> is a collection so that <code>density[i]</code> is the probability of the element <code>set[i]</code> occurring (where <code>i ∈ eachindex(density, set)</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/UnbalancedOptimalTransport.jl#LL23-L34">source</a></section></article><h2 id="Functions-1"><a class="docs-heading-anchor" href="#Functions-1">Functions</a><a class="docs-heading-anchor-permalink" href="#Functions-1" title="Permalink"></a></h2><p>This package provides two functions which act on <a href="public_api.html#UnbalancedOptimalTransport.DiscreteMeasure"><code>DiscreteMeasure</code></a>&#39;s to calculate quantities of interest:</p><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.OT!" href="#UnbalancedOptimalTransport.OT!"><code>UnbalancedOptimalTransport.OT!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function OT!(
    D::AbstractDivergence,
    a::DiscreteMeasure,
    b::DiscreteMeasure,
    ϵ = 1e-1;
    C = (x, y) -&gt; norm(x - y),
    kwargs...,
) -&gt; Number</code></pre><p>Computes the optimal transport cost between <code>a</code> and <code>b</code>, using <a href="public_api.html#UnbalancedOptimalTransport.unbalanced_sinkhorn!"><code>unbalanced_sinkhorn!</code></a>; see that function for the meaning of the parameters and the keyword arguments. Implements Equation (15) of [<a href="optimal_transport.html#SFVTP19-1">SFVTP19</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/sinkhorn.jl#LL108-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.sinkhorn_divergence!" href="#UnbalancedOptimalTransport.sinkhorn_divergence!"><code>UnbalancedOptimalTransport.sinkhorn_divergence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">sinkhorn_divergence!(
    D::AbstractDivergence,
    a::DiscreteMeasure,
    b::DiscreteMeasure,
    ϵ = 1e-1;
    kwargs...,
) -&gt; Number</code></pre><p>Computes the unbalanced sinkhorn divergence between <code>a</code> and <code>b</code> as defined in Def. 6 of [<a href="optimal_transport.html#SFVTP19-1">SFVTP19</a>], using <a href="public_api.html#UnbalancedOptimalTransport.unbalanced_sinkhorn!"><code>unbalanced_sinkhorn!</code></a>; see that function for the meaning of the parameters and the keyword arguments. Sets the optimal <code>dual_potential</code>&#39;s of <code>a</code> and <code>b</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/sinkhorn.jl#LL169-L182">source</a></section></article><h2 id="Sinkhorn&#39;s-algorithm-1"><a class="docs-heading-anchor" href="#Sinkhorn&#39;s-algorithm-1">Sinkhorn&#39;s algorithm</a><a class="docs-heading-anchor-permalink" href="#Sinkhorn&#39;s-algorithm-1" title="Permalink"></a></h2><p>The above functions rely on <a href="public_api.html#UnbalancedOptimalTransport.unbalanced_sinkhorn!"><code>unbalanced_sinkhorn!</code></a> which uses Sinkhorn&#39;s algorithm to calculate the optimal <a href="optimal_transport.html#Dual-potentials-1">Dual potentials</a>.</p><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.unbalanced_sinkhorn!" href="#UnbalancedOptimalTransport.unbalanced_sinkhorn!"><code>UnbalancedOptimalTransport.unbalanced_sinkhorn!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function unbalanced_sinkhorn!(
    D::AbstractDivergence,
    a::DiscreteMeasure,
    b::DiscreteMeasure,
    ϵ = 1e-1;
    C = (x, y) -&gt; norm(x - y),
    tol = 1e-5,
    max_iters = 10^5,
    warn::Bool = true,
) -&gt; NamedTuple</code></pre><p>Implements algorithm 1 of [<a href="optimal_transport.html#SFVTP19-1">SFVTP19</a>]. The <code>dual_potential</code> fields of <code>a</code> and <code>b</code> are updated to hold the optimal dual potentials. The <code>density</code>, <code>log_density</code>, and <code>set</code> fields are not modified. The parameters are</p><ul><li><code>D</code>: the <a href="public_api.html#UnbalancedOptimalTransport.AbstractDivergence"><code>AbstractDivergence</code></a> used for measuring the cost of creating or destroying mass</li><li><code>ϵ</code>: the regularization parameter</li><li><code>C</code>: a function from <code>a.set</code> × <code>b.set</code> to real numbers; should satisfy <code>C(x,y) = C(y,x)</code> and <code>C(x,x)=0</code> when applicable</li><li><code>tol</code>: the convergence tolerance</li><li><code>max_iters</code>: the maximum number of iterations to perform.</li><li><code>warn</code>: whether or not to warn when the maximum number of iterations is reached.</li></ul><p>Returns a NamedTuple of the number of iterations performed (<code>iters</code>), and the maximum residual (<code>max_residual</code>), which is the maximum infinity norm difference between consecutive iterates of the dual potentials, at the end of the process. If <code>max_iters</code> is not reached, iteration stops when the <code>max_residual</code> falls below <code>tol</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/sinkhorn.jl#LL13-L44">source</a></section></article><h2 id="Divergences-1"><a class="docs-heading-anchor" href="#Divergences-1">Divergences</a><a class="docs-heading-anchor-permalink" href="#Divergences-1" title="Permalink"></a></h2><p>As described on the page <a href="optimal_transport.html#Optimal-transport-1">Optimal transport</a>, we use <span>$\varphi$</span>-divergences as penalty terms for mass creation and destruction. This package implements four such divergences, which are all described in Section 2.4 of [<a href="optimal_transport.html#SFVTP19-1">SFVTP19</a>], and are listed below. To add your own divergences, see the <a href="public_api.html#AbstractDivergence-interface-1"><code>AbstractDivergence</code> interface</a> section.</p><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.KL" href="#UnbalancedOptimalTransport.KL"><code>UnbalancedOptimalTransport.KL</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">KL{ρ} &lt;: AbstractDivergence</code></pre><p>Represents the divergence <code>ρ*KL(a|b)</code>, where <code>KL</code> is the Kullback-Leibler divergence. The parameter <code>ρ</code> is simply a scaling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/divergences.jl#LL37-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.TV" href="#UnbalancedOptimalTransport.TV"><code>UnbalancedOptimalTransport.TV</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">TV{ρ} &lt;: AbstractDivergence</code></pre><p>Represents the divergence <code>ρ*TV(u,v) = ρ*norm(u-v,1)</code>, where <code>TV</code> is twice the total variation distance. The parameter <code>ρ</code> is simply a scaling.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/divergences.jl#LL78-L83">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.Balanced" href="#UnbalancedOptimalTransport.Balanced"><code>UnbalancedOptimalTransport.Balanced</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Balanced &lt;: AbstractDivergence</code></pre><p>Represents the divergence <code>Dᵩ(a|b)</code> which is zero if <code>a==b</code> and infinite otherwise. Generalized by <a href="public_api.html#UnbalancedOptimalTransport.RG"><code>RG</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/divergences.jl#LL27-L32">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.RG" href="#UnbalancedOptimalTransport.RG"><code>UnbalancedOptimalTransport.RG</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">RG{l,u} &lt;: AbstractDivergence</code></pre><p>Represents the divergence <code>Dᵩ(a|b)</code> which is zero if <code>l*b .&lt;= a .&lt;= u*b</code> and infinite otherwise. Equivalent to <a href="public_api.html#UnbalancedOptimalTransport.Balanced"><code>Balanced</code></a> when <code>l == u</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/divergences.jl#LL52-L57">source</a></section></article><h3 id="AbstractDivergence-interface-1"><a class="docs-heading-anchor" href="#AbstractDivergence-interface-1"><code>AbstractDivergence</code> interface</a><a class="docs-heading-anchor-permalink" href="#AbstractDivergence-interface-1" title="Permalink"></a></h3><p>To add a divergence <code>MyDivergence</code>, create a <code>struct</code></p><pre><code class="language-julia">struct MyDivergence &lt;: UnbalancedOptimalTransport.AbstractDivergence end</code></pre><p>and implement a method for <a href="public_api.html#UnbalancedOptimalTransport.aprox"><code>UnbalancedOptimalTransport.aprox</code></a> and <a href="public_api.html#UnbalancedOptimalTransport.φstar"><code>UnbalancedOptimalTransport.φstar</code></a>. Optionally, one can also implement a method for <a href="public_api.html#UnbalancedOptimalTransport.initialize_dual_potential!"><code>UnbalancedOptimalTransport.initialize_dual_potential!</code></a> and <a href="public_api.html#UnbalancedOptimalTransport.sinkhorn_divergence!"><code>sinkhorn_divergence!</code></a>, as a specialized implementation may obtain better performance.</p><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.AbstractDivergence" href="#UnbalancedOptimalTransport.AbstractDivergence"><code>UnbalancedOptimalTransport.AbstractDivergence</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">abstract type AbstractDivergence</code></pre><p>An abstract type representing Csiszár φ-divergences. Subtypes should implement <a href="public_api.html#UnbalancedOptimalTransport.φstar"><code>φstar</code></a> and <a href="public_api.html#UnbalancedOptimalTransport.aprox"><code>aprox</code></a>, and optionally can implement <a href="public_api.html#UnbalancedOptimalTransport.initialize_dual_potential!"><code>initialize_dual_potential!</code></a> and/or <a href="public_api.html#UnbalancedOptimalTransport.sinkhorn_divergence!"><code>sinkhorn_divergence!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/divergences.jl#LL1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.aprox" href="#UnbalancedOptimalTransport.aprox"><code>UnbalancedOptimalTransport.aprox</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">aprox(::AbstractDivergence, ϵ::Number, x::Number) -&gt; Number</code></pre><p>The anisotropic proximity operator defined in Def. 2 of [<a href="optimal_transport.html#SFVTP19-1">SFVTP19</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/divergences.jl#LL17-L21">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.φstar" href="#UnbalancedOptimalTransport.φstar"><code>UnbalancedOptimalTransport.φstar</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">φstar(::AbstractDivergence, q::Number) -&gt; Number</code></pre><p>The Legendre conjugate of the function <code>φ</code> associated to the divergence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/divergences.jl#LL10-L14">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.initialize_dual_potential!" href="#UnbalancedOptimalTransport.initialize_dual_potential!"><code>UnbalancedOptimalTransport.initialize_dual_potential!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">initialize_dual_potential!(::AbstractDivergence, a::DiscreteMeasure) -&gt; Nothing</code></pre><p>Apply an initialization for the dual potential, for use in <a href="public_api.html#UnbalancedOptimalTransport.unbalanced_sinkhorn!"><code>unbalanced_sinkhorn!</code></a>; falls back to zeroing out the dual potential. Specialized implementations can improve performance, but should not affect correctness.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/sinkhorn.jl#LL1-L8">source</a></section></article><h2 id="Utilities-1"><a class="docs-heading-anchor" href="#Utilities-1">Utilities</a><a class="docs-heading-anchor-permalink" href="#Utilities-1" title="Permalink"></a></h2><p><a href="public_api.html#UnbalancedOptimalTransport.sinkhorn_divergence!"><code>sinkhorn_divergence!</code></a> uses the following function, which may be specialized to improve performance.</p><article class="docstring"><header><a class="docstring-binding" id="UnbalancedOptimalTransport.fdot" href="#UnbalancedOptimalTransport.fdot"><code>UnbalancedOptimalTransport.fdot</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">fdot(f, u, v) -&gt; Number</code></pre><p>A generic, allocation-free implementation of <code>dot(u, f.(v))</code>. It may be faster to provide a specialized method to dispatch to BLAS or so forth.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ericphanson/UnbalancedOptimalTransport.jl/blob/4d96530891f36312ae05ec20788dc5c4df560e00/src/utilities.jl#LL20-L25">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="optimal_transport.html">« Optimal transport</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 8 January 2020 14:18">Wednesday 8 January 2020</span>. Using Julia version 1.0.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
